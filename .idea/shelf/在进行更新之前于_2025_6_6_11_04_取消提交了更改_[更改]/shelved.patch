Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"AnalysisUIOptions\">\r\n    <option name=\"ANALYZE_INJECTED_CODE\" value=\"false\" />\r\n  </component>\r\n  <component name=\"AutoImportSettings\">\r\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\r\n  </component>\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"69149290-6f72-40b5-b709-8e5e70606f05\" name=\"更改\" comment=\"666\">\r\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/订单通-商品新增.py\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/订单通-商品新增.py\" afterDir=\"false\" />\r\n    </list>\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"FileTemplateManagerImpl\">\r\n    <option name=\"RECENT_TEMPLATES\">\r\n      <list>\r\n        <option value=\"Python Script\" />\r\n      </list>\r\n    </option>\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n    <option name=\"SIGN_OFF_COMMIT\" value=\"true\" />\r\n  </component>\r\n  <component name=\"MarkdownSettingsMigration\">\r\n    <option name=\"stateVersion\" value=\"1\" />\r\n  </component>\r\n  <component name=\"ProblemsViewState\">\r\n    <option name=\"selectedTabId\" value=\"CurrentFile\" />\r\n  </component>\r\n  <component name=\"ProjectColorInfo\">{\r\n  &quot;associatedIndex&quot;: 4\r\n}</component>\r\n  <component name=\"ProjectId\" id=\"2xNzZehL8My2pb1RFtaB8VWEOvG\" />\r\n  <component name=\"ProjectLevelVcsManager\" settingsEditedManually=\"true\" />\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\">{\r\n  &quot;keyToString&quot;: {\r\n    &quot;Python.11.executor&quot;: &quot;Run&quot;,\r\n    &quot;Python.main.executor&quot;: &quot;Debug&quot;,\r\n    &quot;Python.仓单管理.executor&quot;: &quot;Debug&quot;,\r\n    &quot;Python.查看详情.executor&quot;: &quot;Run&quot;,\r\n    &quot;Python.统一交收.executor&quot;: &quot;Run&quot;,\r\n    &quot;Python.订单通-交收管理.executor&quot;: &quot;Run&quot;,\r\n    &quot;Python.订单通-商品上市数据录入.executor&quot;: &quot;Run&quot;,\r\n    &quot;Python.订单通-商品上市数据录入并提交.executor&quot;: &quot;Run&quot;,\r\n    &quot;Python.订单通-商品新增.executor&quot;: &quot;Run&quot;,\r\n    &quot;Python.订单通商品新增-待上市.executor&quot;: &quot;Run&quot;,\r\n    &quot;Python.采销通-商品新增.executor&quot;: &quot;Run&quot;,\r\n    &quot;Python.采销通-商品详情.executor&quot;: &quot;Run&quot;,\r\n    &quot;RunOnceActivity.OpenProjectViewOnStart&quot;: &quot;true&quot;,\r\n    &quot;RunOnceActivity.ShowReadmeOnStart&quot;: &quot;true&quot;,\r\n    &quot;deletionFromPopupRequiresConfirmation&quot;: &quot;false&quot;,\r\n    &quot;git-widget-placeholder&quot;: &quot;master&quot;,\r\n    &quot;last_opened_file_path&quot;: &quot;E:/test_商品新增【采销通】&quot;,\r\n    &quot;run.code.analysis.last.selected.profile&quot;: &quot;pProject Default&quot;,\r\n    &quot;settings.editor.selected.configurable&quot;: &quot;reference.settings.ide.settings.new.ui&quot;\r\n  }\r\n}</component>\r\n  <component name=\"SharedIndexes\">\r\n    <attachedChunks>\r\n      <set>\r\n        <option value=\"bundled-python-sdk-c69650fc56ca-d3b881c8e49f-com.jetbrains.pycharm.community.sharedIndexes.bundled-PC-233.15619.17\" />\r\n      </set>\r\n    </attachedChunks>\r\n  </component>\r\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"应用程序级\" UseSingleDictionary=\"true\" transferred=\"true\" />\r\n  <component name=\"TaskManager\">\r\n    <task active=\"true\" id=\"Default\" summary=\"默认任务\">\r\n      <changelist id=\"69149290-6f72-40b5-b709-8e5e70606f05\" name=\"更改\" comment=\"\" />\r\n      <created>1747793376124</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1747793376124</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00001\" summary=\"新增采销通-商品新增\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1747805553566</created>\r\n      <option name=\"number\" value=\"00001\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00001\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1747805553566</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00002\" summary=\"111\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1747893901550</created>\r\n      <option name=\"number\" value=\"00002\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00002\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1747893901550</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00003\" summary=\"222\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1747898871548</created>\r\n      <option name=\"number\" value=\"00003\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00003\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1747898871548</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00004\" summary=\"333\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1747984115545</created>\r\n      <option name=\"number\" value=\"00004\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00004\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1747984115545</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00005\" summary=\"333\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1747989547281</created>\r\n      <option name=\"number\" value=\"00005\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00005\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1747989547281</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00006\" summary=\"444\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1747989833671</created>\r\n      <option name=\"number\" value=\"00006\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00006\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1747989833671</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00007\" summary=\"444\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1748220656994</created>\r\n      <option name=\"number\" value=\"00007\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00007\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1748220656994</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00008\" summary=\"444\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1748221270007</created>\r\n      <option name=\"number\" value=\"00008\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00008\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1748221270007</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00009\" summary=\"555\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1748247503340</created>\r\n      <option name=\"number\" value=\"00009\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00009\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1748247503340</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00010\" summary=\"555\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1748248868415</created>\r\n      <option name=\"number\" value=\"00010\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00010\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1748248868415</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00011\" summary=\"666\">\r\n      <option name=\"closed\" value=\"true\" />\r\n      <created>1748421884567</created>\r\n      <option name=\"number\" value=\"00011\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00011\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1748421884567</updated>\r\n    </task>\r\n    <option name=\"localTasksCounter\" value=\"12\" />\r\n    <servers />\r\n  </component>\r\n  <component name=\"Vcs.Log.Tabs.Properties\">\r\n    <option name=\"OPEN_GENERIC_TABS\">\r\n      <map>\r\n        <entry key=\"bf01d401-cebf-4114-888a-ab8d5a0445c2\" value=\"TOOL_WINDOW\" />\r\n      </map>\r\n    </option>\r\n    <option name=\"RECENT_FILTERS\">\r\n      <map>\r\n        <entry key=\"Branch\">\r\n          <value>\r\n            <list>\r\n              <RecentGroup>\r\n                <option name=\"FILTER_VALUES\">\r\n                  <option value=\"master\" />\r\n                </option>\r\n              </RecentGroup>\r\n            </list>\r\n          </value>\r\n        </entry>\r\n        <entry key=\"User\">\r\n          <value>\r\n            <list>\r\n              <RecentGroup>\r\n                <option name=\"FILTER_VALUES\">\r\n                  <option value=\"*\" />\r\n                </option>\r\n              </RecentGroup>\r\n            </list>\r\n          </value>\r\n        </entry>\r\n      </map>\r\n    </option>\r\n    <option name=\"TAB_STATES\">\r\n      <map>\r\n        <entry key=\"MAIN\">\r\n          <value>\r\n            <State>\r\n              <option name=\"FILTERS\">\r\n                <map>\r\n                  <entry key=\"branch\">\r\n                    <value>\r\n                      <list>\r\n                        <option value=\"master\" />\r\n                      </list>\r\n                    </value>\r\n                  </entry>\r\n                  <entry key=\"user\">\r\n                    <value>\r\n                      <list>\r\n                        <option value=\"*\" />\r\n                      </list>\r\n                    </value>\r\n                  </entry>\r\n                </map>\r\n              </option>\r\n            </State>\r\n          </value>\r\n        </entry>\r\n        <entry key=\"bf01d401-cebf-4114-888a-ab8d5a0445c2\">\r\n          <value>\r\n            <State>\r\n              <option name=\"FILTERS\">\r\n                <map>\r\n                  <entry key=\"branch\">\r\n                    <value>\r\n                      <list>\r\n                        <option value=\"HEAD\" />\r\n                      </list>\r\n                    </value>\r\n                  </entry>\r\n                  <entry key=\"structure\">\r\n                    <value>\r\n                      <list>\r\n                        <option value=\"dir:E:/test_交易后台/.idea\" />\r\n                      </list>\r\n                    </value>\r\n                  </entry>\r\n                </map>\r\n              </option>\r\n              <option name=\"SHOW_ONLY_AFFECTED_CHANGES\" value=\"true\" />\r\n            </State>\r\n          </value>\r\n        </entry>\r\n      </map>\r\n    </option>\r\n  </component>\r\n  <component name=\"VcsManagerConfiguration\">\r\n    <MESSAGE value=\"新增采销通-商品新增\" />\r\n    <MESSAGE value=\"111\" />\r\n    <MESSAGE value=\"222\" />\r\n    <MESSAGE value=\"333&#10;&#10;Signed-off-by: Administrator &lt;xuetaocwy@163.com&gt;\" />\r\n    <MESSAGE value=\"333\" />\r\n    <MESSAGE value=\"444\" />\r\n    <MESSAGE value=\"555\" />\r\n    <MESSAGE value=\"666\" />\r\n    <option name=\"LAST_COMMIT_MESSAGE\" value=\"666\" />\r\n  </component>\r\n  <component name=\"XDebuggerManager\">\r\n    <breakpoint-manager>\r\n      <default-breakpoints>\r\n        <breakpoint type=\"python-exception\">\r\n          <properties notifyOnTerminate=\"true\" exception=\"BaseException\">\r\n            <option name=\"notifyOnTerminate\" value=\"true\" />\r\n          </properties>\r\n        </breakpoint>\r\n      </default-breakpoints>\r\n    </breakpoint-manager>\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision 043d5f1ae3a69417417646869ceea58b43eff9b8)
+++ b/.idea/workspace.xml	(date 1749178988736)
@@ -7,7 +7,7 @@
     <option name="autoReloadType" value="SELECTIVE" />
   </component>
   <component name="ChangeListManager">
-    <list default="true" id="69149290-6f72-40b5-b709-8e5e70606f05" name="更改" comment="666">
+    <list default="true" id="69149290-6f72-40b5-b709-8e5e70606f05" name="更改" comment="">
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/订单通-商品新增.py" beforeDir="false" afterPath="$PROJECT_DIR$/订单通-商品新增.py" afterDir="false" />
     </list>
@@ -42,29 +42,29 @@
     <option name="hideEmptyMiddlePackages" value="true" />
     <option name="showLibraryContents" value="true" />
   </component>
-  <component name="PropertiesComponent">{
-  &quot;keyToString&quot;: {
-    &quot;Python.11.executor&quot;: &quot;Run&quot;,
-    &quot;Python.main.executor&quot;: &quot;Debug&quot;,
-    &quot;Python.仓单管理.executor&quot;: &quot;Debug&quot;,
-    &quot;Python.查看详情.executor&quot;: &quot;Run&quot;,
-    &quot;Python.统一交收.executor&quot;: &quot;Run&quot;,
-    &quot;Python.订单通-交收管理.executor&quot;: &quot;Run&quot;,
-    &quot;Python.订单通-商品上市数据录入.executor&quot;: &quot;Run&quot;,
-    &quot;Python.订单通-商品上市数据录入并提交.executor&quot;: &quot;Run&quot;,
-    &quot;Python.订单通-商品新增.executor&quot;: &quot;Run&quot;,
-    &quot;Python.订单通商品新增-待上市.executor&quot;: &quot;Run&quot;,
-    &quot;Python.采销通-商品新增.executor&quot;: &quot;Run&quot;,
-    &quot;Python.采销通-商品详情.executor&quot;: &quot;Run&quot;,
-    &quot;RunOnceActivity.OpenProjectViewOnStart&quot;: &quot;true&quot;,
-    &quot;RunOnceActivity.ShowReadmeOnStart&quot;: &quot;true&quot;,
-    &quot;deletionFromPopupRequiresConfirmation&quot;: &quot;false&quot;,
-    &quot;git-widget-placeholder&quot;: &quot;master&quot;,
-    &quot;last_opened_file_path&quot;: &quot;E:/test_商品新增【采销通】&quot;,
-    &quot;run.code.analysis.last.selected.profile&quot;: &quot;pProject Default&quot;,
-    &quot;settings.editor.selected.configurable&quot;: &quot;reference.settings.ide.settings.new.ui&quot;
+  <component name="PropertiesComponent"><![CDATA[{
+  "keyToString": {
+    "Python.11.executor": "Run",
+    "Python.main.executor": "Debug",
+    "Python.仓单管理.executor": "Debug",
+    "Python.查看详情.executor": "Run",
+    "Python.统一交收.executor": "Run",
+    "Python.订单通-交收管理.executor": "Run",
+    "Python.订单通-商品上市数据录入.executor": "Run",
+    "Python.订单通-商品上市数据录入并提交.executor": "Debug",
+    "Python.订单通-商品新增.executor": "Run",
+    "Python.订单通商品新增-待上市.executor": "Run",
+    "Python.采销通-商品新增.executor": "Run",
+    "Python.采销通-商品详情.executor": "Run",
+    "RunOnceActivity.OpenProjectViewOnStart": "true",
+    "RunOnceActivity.ShowReadmeOnStart": "true",
+    "deletionFromPopupRequiresConfirmation": "false",
+    "git-widget-placeholder": "master",
+    "last_opened_file_path": "E:/test_商品新增【采销通】",
+    "run.code.analysis.last.selected.profile": "pProject Default",
+    "settings.editor.selected.configurable": "reference.settings.ide.settings.new.ui"
   }
-}</component>
+}]]></component>
   <component name="SharedIndexes">
     <attachedChunks>
       <set>
@@ -169,7 +169,15 @@
       <option name="project" value="LOCAL" />
       <updated>1748421884567</updated>
     </task>
-    <option name="localTasksCounter" value="12" />
+    <task id="LOCAL-00012" summary="999">
+      <option name="closed" value="true" />
+      <created>1748486882548</created>
+      <option name="number" value="00012" />
+      <option name="presentableId" value="LOCAL-00012" />
+      <option name="project" value="LOCAL" />
+      <updated>1748486882548</updated>
+    </task>
+    <option name="localTasksCounter" value="13" />
     <servers />
   </component>
   <component name="Vcs.Log.Tabs.Properties">
@@ -267,7 +275,8 @@
     <MESSAGE value="444" />
     <MESSAGE value="555" />
     <MESSAGE value="666" />
-    <option name="LAST_COMMIT_MESSAGE" value="666" />
+    <MESSAGE value="999" />
+    <option name="LAST_COMMIT_MESSAGE" value="999" />
   </component>
   <component name="XDebuggerManager">
     <breakpoint-manager>
Index: 订单通-商品新增.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+># 需修改商品名称与商品代码1\r\nfrom selenium import webdriver\r\nfrom selenium.webdriver.common.by import By\r\nfrom selenium.webdriver.support import expected_conditions as EC\r\nfrom selenium.webdriver.support.ui import WebDriverWait\r\nimport time\r\n\r\n# 初始化 WebDriver\r\ndriver = webdriver.Chrome()\r\ndriver.implicitly_wait(5)\r\n\r\ntry:\r\n    # 登录流程\r\n    driver.get(\"https://center-uat2.tjpgx.cn/system/login.htm\")\r\n    driver.maximize_window()\r\n\r\n    # 输入账号密码\r\n    account_input = WebDriverWait(driver, 5).until(\r\n        EC.presence_of_element_located((By.ID, \"account\"))\r\n    )\r\n    account_input.send_keys(\"xt\")\r\n\r\n    password_input = driver.find_element(By.ID, \"password\")\r\n    password_input.send_keys(\"1234567a\")\r\n\r\n    # 点击登录按钮\r\n    login_button = WebDriverWait(driver, 5).until(\r\n        EC.element_to_be_clickable((By.XPATH, \"//input[@onclick='doLogin()']\"))\r\n    )\r\n    login_button.click()\r\n    print(\"成功登录系统\")\r\n\r\n    # 等待登录完成后的页面加载\r\n    WebDriverWait(driver, 5).until(\r\n        EC.presence_of_element_located(\r\n            (By.XPATH, \"//a[contains(@onclick, 'menuV2.htm') and contains(text(), '订单交易')]\"))\r\n    )\r\n\r\n    # 点击订单交易按钮\r\n    order_button = WebDriverWait(driver, 5).until(\r\n        EC.element_to_be_clickable((By.XPATH, \"//a[contains(@onclick, 'menuV2.htm') and contains(text(), '订单交易')]\"))\r\n    )\r\n    order_button.click()\r\n    print(\"成功进入订单交易页面\")\r\n\r\n    # 点击商品管理按钮\r\n    ctbasegoods_button = WebDriverWait(driver, 5).until(\r\n        EC.element_to_be_clickable((By.CSS_SELECTOR, \"a[title='商品管理'][name*='ctbasegoods'][uniq='14996']\"))\r\n    )\r\n    ctbasegoods_button.click()\r\n    print(\"成功进入商品管理页面\")\r\n\r\n    # 切换到第一个 iframe\r\n    first_iframe = WebDriverWait(driver, 5).until(\r\n        EC.presence_of_element_located(\r\n            (By.CSS_SELECTOR, \"iframe[src='https://ctms-uat2.tjpgx.cn/base/ctbasegoods.htm']\")\r\n        )\r\n    )\r\n    driver.switch_to.frame(first_iframe)\r\n    print(\"成功切换到第一个 iframe\")\r\n\r\n    # 点击下一交易日生效按钮\r\n    tab_element = WebDriverWait(driver, 5).until(\r\n        EC.element_to_be_clickable((By.CSS_SELECTOR, \"a.tab[tab='tab_2'][tab_src*='ctbasegoods/list.htm']\"))\r\n    )\r\n    tab_element.click()\r\n    print(\"成功进入下一交易日生效页面\")\r\n\r\n    # 切换到第二个 iframe\r\n    second_iframe = WebDriverWait(driver, 5).until(\r\n        EC.presence_of_element_located(\r\n            (By.CSS_SELECTOR, \"iframe[src='https://ctms-uat2.tjpgx.cn/base/ctbasegoods/list.htm']\")\r\n        )\r\n    )\r\n    driver.switch_to.frame(second_iframe)\r\n    print(\"成功切换到第二个 iframe\")\r\n\r\n    # 点击新增按钮\r\n    add_button = WebDriverWait(driver, 5).until(\r\n        EC.element_to_be_clickable(\r\n            (By.CSS_SELECTOR, \"a.bt_add[href='https://ctms-uat2.tjpgx.cn/base/ctbasegoods/add.htm']\")\r\n        )\r\n    )\r\n    add_button.click()\r\n    print(\"成功打开商品新增页面\")\r\n\r\n    # 点击参照商品信息\r\n    goods_selector = WebDriverWait(driver, 5).until(\r\n        EC.element_to_be_clickable((By.ID, \"templateGoodsCode\"))\r\n    )\r\n    goods_selector.click()\r\n    print(\"成功打开选择参照商品页面\")\r\n\r\n    # 切换到第三层 iframe（关键优化点）\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n\r\n        driver.switch_to.frame(first_iframe)\r\n\r\n        # 定位并切换到第三个 iframe（使用更宽松的 CSS 选择器）\r\n        third_iframe = WebDriverWait(driver, 5).until(\r\n            EC.frame_to_be_available_and_switch_to_it(\r\n                (By.CSS_SELECTOR, \"iframe[src*='goodsReference.htm']\")\r\n            )\r\n        )\r\n        print(\"成功切换到第三个 iframe\")\r\n\r\n        # 选择参数商品\r\n        select_button = WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable(\r\n                (By.XPATH, \"//a[contains(@onclick, '测试液化天然气5月下') and text()='选择']\")\r\n            )\r\n        )\r\n        select_button.click()\r\n        print(\"成功选择商品 测试液化天然气5月下\")\r\n\r\n    except Exception as e:\r\n        print(f\"切换到第三个 iframe 失败：{str(e)}\")\r\n        raise  # 抛出异常以便外部捕获\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n        driver.switch_to.frame(second_iframe)\r\n\r\n        # 等待商品代码输入框加载完成，并输入商品代码\r\n        goods_code_input = WebDriverWait(driver, 5).until(\r\n            EC.presence_of_element_located((By.ID, \"goodsCode\"))\r\n        )\r\n        goods_code_input.clear()\r\n        goods_code_input.send_keys(\"Automation04\")\r\n        print(\"成功输入商品代码\")\r\n\r\n        # 等待商品名称输入框加载完成，并输入商品名称\r\n        goods_name_input = WebDriverWait(driver, 5).until(\r\n            EC.presence_of_element_located((By.ID, \"goodsName\"))\r\n        )\r\n        goods_name_input.clear()\r\n        goods_name_input.send_keys(\"自动化04\")\r\n        print(\"成功输入商品名称\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n        driver.save_screenshot(\"error.png\")\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n        driver.switch_to.frame(second_iframe)\r\n\r\n        # 点击触发下拉框展开\r\n        driver.find_element(By.ID, \"nDay\").click()\r\n\r\n        # 定位并点击「当日定转」选项\r\n        WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable((By.XPATH, \"//option[text()='允许']\"))\r\n        ).click()\r\n        print(\"成功选择 允许当日定转\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n        driver.save_screenshot(\"error.png\")\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n        driver.switch_to.frame(second_iframe)\r\n\r\n        # 点击触发下拉框展开\r\n        driver.find_element(By.ID, \"isDailyDelivery\").click()\r\n\r\n        # 定位并点击「提前交收」选项\r\n        WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable((By.XPATH, \"//option[text()='允许']\"))\r\n        ).click()\r\n        print(\"成功选择 允许提前交收\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n        driver.save_screenshot(\"error.png\")\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n        driver.switch_to.frame(second_iframe)\r\n\r\n        # 点击触发下拉框展开\r\n        driver.find_element(By.ID, \"deliveryType\").click()\r\n\r\n        # 定位并点击「线下交收」选项\r\n        WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable((By.XPATH, \"//option[text()='线下交收']\"))\r\n        ).click()\r\n        print(\"成功选择线下交收\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n        driver.save_screenshot(\"error.png\")\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n        driver.switch_to.frame(second_iframe)\r\n\r\n        # 点击触发下拉框展开\r\n        driver.find_element(By.ID, \"settleType\").click()\r\n\r\n        # 定位并点击「线下结算」选项\r\n        WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable((By.XPATH, \"//option[text()='线下结算']\"))\r\n        ).click()\r\n        print(\"成功选择结算方式\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n        driver.save_screenshot(\"error.png\")\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n        driver.switch_to.frame(second_iframe)\r\n\r\n        # 定位上市日期输入框\r\n        date_input = WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable((By.ID, \"validDate\"))\r\n        )\r\n\r\n        # 点击输入框触发上市日期选择器\r\n        driver.execute_script(\"arguments[0].scrollIntoView(true);\", date_input)\r\n        date_input.click()\r\n        print(\"成功触发日期控件弹出\")\r\n\r\n        # 定位并切换到第四个 iframe\r\n        four_iframe = WebDriverWait(driver, 5).until(\r\n            EC.frame_to_be_available_and_switch_to_it(\r\n                (By.CSS_SELECTOR, \"iframe[src*='My97DatePicker.html']\")\r\n            )\r\n        )\r\n        print(\"成功切换到第四个 iframe\")\r\n\r\n        # 定位上市日期选择器元素\r\n        WebDriverWait(driver, 5).until(\r\n            EC.presence_of_element_located((By.CLASS_NAME, \"Wselday\"))\r\n        )\r\n\r\n        # 定位目标日期元素\r\n        target_date = WebDriverWait(driver, 10).until(\r\n               EC.element_to_be_clickable((By.ID, \"dpOkInput\"))\r\n        )\r\n        # 点击选择上市日期\r\n        target_date.click()\r\n        print(\"成功选择上市日期\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n        driver.save_screenshot(\"error.png\")\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n        driver.switch_to.frame(second_iframe)\r\n\r\n        # 定位最后交易日期输入框\r\n        date_input = WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable((By.ID, \"invalidDate\"))\r\n        )\r\n\r\n        # 点击输入框触发最后交易日期选择器\r\n        driver.execute_script(\"arguments[0].scrollIntoView(true);\", date_input)\r\n        date_input.click()\r\n        print(\"成功触发最后交易日期控件弹出\")\r\n\r\n        # 定位并切换到第四个 iframe\r\n        four_iframe = WebDriverWait(driver, 5).until(\r\n            EC.frame_to_be_available_and_switch_to_it(\r\n                (By.CSS_SELECTOR, \"iframe[src*='My97DatePicker.html']\")\r\n            )\r\n        )\r\n        print(\"成功切换到第四个 iframe\")\r\n\r\n        # 定位目标日期元素\r\n        target_date = WebDriverWait(driver, 10).until(\r\n               EC.element_to_be_clickable((By.ID, \"dpOkInput\"))\r\n        )\r\n        # 点击选择最后交易日期\r\n        target_date.click()\r\n        print(\"成功选择最后委托日期\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n        driver.save_screenshot(\"error.png\")\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n        driver.switch_to.frame(second_iframe)\r\n\r\n        # 定位交收开始日期输入框\r\n        date_input = WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable((By.ID, \"deliveryBeginDate\"))\r\n        )\r\n\r\n        # 点击输入框触发交收开始日期选择器\r\n        driver.execute_script(\"arguments[0].scrollIntoView(true);\", date_input)\r\n        date_input.click()\r\n        print(\"成功触发交收开始日期控件弹出\")\r\n\r\n        # 定位并切换到第四个 iframe\r\n        four_iframe = WebDriverWait(driver, 5).until(\r\n            EC.frame_to_be_available_and_switch_to_it(\r\n                (By.CSS_SELECTOR, \"iframe[src*='My97DatePicker.html']\")\r\n            )\r\n        )\r\n        print(\"成功切换到第四个 iframe\")\r\n\r\n        # 定位目标日期元素\r\n        target_date = WebDriverWait(driver, 10).until(\r\n               EC.element_to_be_clickable((By.ID, \"dpOkInput\"))\r\n        )\r\n        # 点击选择交收开始日期\r\n        target_date.click()\r\n        print(\"成功选择交收开始日期\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n        driver.save_screenshot(\"error.png\")\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n        driver.switch_to.frame(second_iframe)\r\n\r\n        # 定位交收结束日期输入框\r\n        date_input = WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable((By.ID, \"deliveryEndDate\"))\r\n        )\r\n\r\n        # 点击输入框触发交收结束日期选择器\r\n        driver.execute_script(\"arguments[0].scrollIntoView(true);\", date_input)\r\n        date_input.click()\r\n        print(\"成功触发交收结束日期控件弹出\")\r\n\r\n        # 定位并切换到第四个 iframe\r\n        four_iframe = WebDriverWait(driver, 5).until(\r\n            EC.frame_to_be_available_and_switch_to_it(\r\n                (By.CSS_SELECTOR, \"iframe[src*='My97DatePicker.html']\")\r\n            )\r\n        )\r\n        print(\"成功切换到第四个 iframe\")\r\n\r\n        # 定位交收结束日期日期元素\r\n        target_date = WebDriverWait(driver, 10).until(\r\n               EC.element_to_be_clickable((By.ID, \"dpOkInput\"))\r\n        )\r\n        # 点击选择交收结束日期\r\n        target_date.click()\r\n        print(\"成功选择交收结束日期\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n        driver.save_screenshot(\"error.png\")\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n        driver.switch_to.frame(second_iframe)\r\n\r\n        # 定位双向持单截止日期输入框\r\n        date_input = WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable((By.ID, \"expireDate\"))\r\n        )\r\n\r\n        # 点击输入框触发双向持单截止日期选择器\r\n        driver.execute_script(\"arguments[0].scrollIntoView(true);\", date_input)\r\n        date_input.click()\r\n        print(\"成功触发双向持单截止日期日期控件弹出\")\r\n\r\n        # 定位并切换到第四个 iframe\r\n        four_iframe = WebDriverWait(driver, 5).until(\r\n            EC.frame_to_be_available_and_switch_to_it(\r\n                (By.CSS_SELECTOR, \"iframe[src*='My97DatePicker.html']\")\r\n            )\r\n        )\r\n        print(\"成功切换到第四个 iframe\")\r\n\r\n        # 定位双向持单截止日期元素\r\n        target_date = WebDriverWait(driver, 10).until(\r\n               EC.element_to_be_clickable((By.ID, \"dpOkInput\"))\r\n        )\r\n        # 点击选择双向持单截止日期\r\n        target_date.click()\r\n        print(\"成功选择双向持单截止日期\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n        driver.save_screenshot(\"error.png\")\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n        driver.switch_to.frame(second_iframe)\r\n\r\n        # 点击行纪服务商信息\r\n        Brokerage_service_provider = WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable((By.ID, \"brokerAccountNo\"))\r\n        )\r\n        Brokerage_service_provider.click()\r\n        print(\"成功打开选择行纪服务商信息页面\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n        driver.save_screenshot(\"error.png\")\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n\r\n        # 定位并切换到第五个 iframe\r\n        five_iframe = WebDriverWait(driver, 5).until(\r\n            EC.frame_to_be_available_and_switch_to_it(\r\n                (By.XPATH, \"//iframe[contains(@src, 'userTypeChooseReference.htm')]\")\r\n            )\r\n        )\r\n        print(\"成功切换到第五个 iframe\")\r\n\r\n        # 选择行纪服务商参数\r\n        select_button = WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable(\r\n                (By.XPATH, \"//a[text()='选择' and contains(@onclick, 'ssj_buyer')]\")\r\n            )\r\n        )\r\n\r\n        # 点击操作\r\n        select_button.click()\r\n        print(\"成功选择行纪服务商 买方测试\")\r\n\r\n    except Exception as e:\r\n        print(f\"切换到第五个 iframe 失败：{str(e)}\")\r\n        raise\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n        driver.switch_to.frame(second_iframe)\r\n\r\n        # 定位并点击保存按钮\r\n        save_button = WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable(\r\n                (By.XPATH, \"//button[contains(@class, 'btn_commit') and contains(text(), '保 存')]\")\r\n            )\r\n        )\r\n        save_button.click()\r\n        print(\"成功点击保存按钮\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n        driver.save_screenshot(\"error.png\")\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n\r\n        # 定位并点击按钮\r\n        confirm_button = WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable(\r\n                (By.XPATH, \"//button[contains(@class, 'aui_strongButton') and normalize-space()='确定']\")\r\n            )\r\n        )\r\n        confirm_button.click()\r\n        print(\"成功点击确定按钮\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n\r\n    try:\r\n        # 先返回到默认顶层框架，确保后续定位不受嵌套影响\r\n        driver.switch_to.default_content()\r\n        driver.switch_to.frame(first_iframe)\r\n        driver.switch_to.frame(second_iframe)\r\n\r\n        # 显式等待并点击\r\n        back_button = WebDriverWait(driver, 5).until(\r\n            EC.element_to_be_clickable(\r\n                (By.XPATH, \"//button[contains(@class, 'button-s10') and text()='返回']\")\r\n            )\r\n        )\r\n        back_button.click()\r\n        print(\"成功点击返回按钮\")\r\n\r\n    except Exception as e:\r\n        print(f\"操作失败: {str(e)}\")\r\n\r\nfinally:\r\n    # 返回主文档并关闭浏览器\r\n    driver.switch_to.default_content()\r\n    driver.quit()\r\n    print(\"浏览器已关闭\")\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/订单通-商品新增.py b/订单通-商品新增.py
--- a/订单通-商品新增.py	(revision 043d5f1ae3a69417417646869ceea58b43eff9b8)
+++ b/订单通-商品新增.py	(date 1749093248793)
@@ -109,11 +109,11 @@
         # 选择参数商品
         select_button = WebDriverWait(driver, 5).until(
             EC.element_to_be_clickable(
-                (By.XPATH, "//a[contains(@onclick, '测试液化天然气5月下') and text()='选择']")
+                (By.XPATH, "//a[contains(@onclick, '胖阿硕的压测商品') and text()='选择']")
             )
         )
         select_button.click()
-        print("成功选择商品 测试液化天然气5月下")
+        print("成功选择商品 胖阿硕的压测商品")
 
     except Exception as e:
         print(f"切换到第三个 iframe 失败：{str(e)}")
@@ -130,7 +130,7 @@
             EC.presence_of_element_located((By.ID, "goodsCode"))
         )
         goods_code_input.clear()
-        goods_code_input.send_keys("Automation04")
+        goods_code_input.send_keys("Automation10")
         print("成功输入商品代码")
 
         # 等待商品名称输入框加载完成，并输入商品名称
@@ -138,7 +138,7 @@
             EC.presence_of_element_located((By.ID, "goodsName"))
         )
         goods_name_input.clear()
-        goods_name_input.send_keys("自动化04")
+        goods_name_input.send_keys("自动化10")
         print("成功输入商品名称")
 
     except Exception as e:
